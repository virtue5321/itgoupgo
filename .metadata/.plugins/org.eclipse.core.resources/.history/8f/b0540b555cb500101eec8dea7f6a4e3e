<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="jakarta.tags.core" %>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>${boardName} ê²Œì‹œê¸€ ê´€ë¦¬</title> 

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    
    <style>
        body {
            /* í—¤ë”ì™€ ë©”ë‰´ë°”ë¥¼ ìœ„í•œ ê³µê°„ í™•ë³´ ë˜ëŠ” ë°°ê²½ìƒ‰ ì§€ì • */
            background-color: #f9f9fb;
        }
        
        /* ì´ì „ ë‹µë³€ì—ì„œ í†µì¼í•œ ìŠ¤íƒ€ì¼ ìœ ì§€ */
        .page-title {
            font-size: 1.6rem;
            font-weight: bold;
            margin-bottom: 1.2rem;
            color: #333;
        }
        .admin-card {
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            padding: 25px;
            min-height: 70vh; /* ì½˜í…ì¸ ê°€ ì ì„ ë•Œë„ ê¹”ë”í•˜ê²Œ ë³´ì´ë„ë¡ ìµœì†Œ ë†’ì´ ì„¤ì • */
        }
        table th {
            background-color: #f3f4f6;
            font-weight: 600;
        }
        table td, th {
            vertical-align: middle;
        }
        .pagination {
            justify-content: center;
        }
        .action-cell {
             white-space: nowrap;
        }
        
        /* ==================================== */
        /* ğŸ’¡ ê´€ë¦¬ì ë ˆì´ì•„ì›ƒì„ ìœ„í•œ ê¸°ë³¸ êµ¬ì¡° ìŠ¤íƒ€ì¼ */
        /* ì´ ë¶€ë¶„ì€ ì‹¤ì œ ë ˆì´ì•„ì›ƒ ë°©ì‹ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤. */
        .admin-wrapper {
             display: flex; /* ë©”ë‰´ë°”(sidebar)ì™€ ì½˜í…ì¸  ì˜ì—­(main-content)ì„ ê°€ë¡œë¡œ ë°°ì¹˜ */
        }
        .main-content {
             flex-grow: 1;
             padding: 20px;
        }
        /* ==================================== */
    </style>
</head>
<body>

    <%-- <jsp:include page="[TODO: header.jsp ê²½ë¡œ]" /> --%>

    <div class="admin-wrapper">
        <%-- <jsp:include page="[TODO: sidebar.jsp ê²½ë¡œ]" /> --%>
        
        <div class="main-content">
            <div class="container-fluid"> <%-- container ëŒ€ì‹  fluidë¥¼ ì‚¬ìš©í•´ ë©”ë‰´ë°” ì˜† ê³µê°„ì„ ìµœëŒ€í•œ í™œìš© --%>

                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h2 class="page-title">ğŸ“‚ ${boardName} ê´€ë¦¬</h2>
                    <%-- ì´ ë’¤ë¡œê°€ê¸° ë²„íŠ¼ì€ ìƒë‹¨/ì¢Œì¸¡ ë©”ë‰´ê°€ ìˆë‹¤ë©´ ë¶ˆí•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. --%>
                    <a href="/community/admin/post" class="btn btn-outline-secondary btn-sm back-btn">ê²Œì‹œíŒ ëª©ë¡</a>
                </div>
            
                <div class="admin-card">
                    <form id="postActionForm" action="/community/admin/post/delete" method="post">
                        <div class="d-flex justify-content-start mb-3">
                            <button type="button" class="btn btn-danger btn-sm" onclick="submitPostAction('ì‚­ì œ')">
                                ì„ íƒ ê²Œì‹œê¸€ ì‚­ì œ
                            </button>
                        </div>
            
                        <table class="table table-hover align-middle">
                            <thead>
                                <tr>
                                    <th style="width:5%;"><input type="checkbox" id="selectAllCheckboxPost"></th>
                                    <th style="width:8%;">ê¸€ë²ˆí˜¸</th>
                                    <th style="width:30%;">ì œëª©</th>
                                    <th style="width:15%;">ì‘ì„±ì</th>
                                    <th style="width:12%;">ì‘ì„±ì¼</th>
                                    <th style="width:8%;">ì¡°íšŒìˆ˜</th>
                                    <th style="width:12%;">ê´€ë¦¬</th>
                                </tr>
                            </thead>
                            <tbody>
                                <c:if test="${empty bbsList}">
                                    <tr>
                                        <td colspan="7" class="text-center text-muted py-4">
                                            ë“±ë¡ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.
                                        </td>
                                    </tr>
                                </c:if>
            
                                <c:forEach var="post" items="${bbsList}">
                                    <tr>
                                        <td><input type="checkbox" class="itemCheckboxPost" name="bbsNoList" value="${post.bbsNo}"></td>
                                        <td>${post.bbsNo}</td>
                                        <td class="text-start">
                                            <a href="/community/admin/post/detail?bbsNo=${post.bbsNo}" class="text-dark text-decoration-none">
                                                ${post.bbsTitle}
                                            </a>
                                            <c:if test="${post.replyCount > 0}">
                                                <span class="badge text-bg-secondary ms-1">${post.replyCount}</span>
                                            </c:if>
                                        </td>
                                        <td>${post.bbsWriter}</td>
                                        <td>${post.createDate}</td>
                                        <td>${post.bbsCount}</td>
                                        
                                        <td class="action-cell">
                                            <a href="/community/admin/post/edit?bbsNo=${post.bbsNo}" class="btn btn-outline-primary btn-sm me-1">ìˆ˜ì •</a>
                                            <a href="/community/admin/post/delete?bbsNo=${post.bbsNo}" class="btn btn-outline-danger btn-sm" 
                                               onclick="return confirm('${post.bbsNo}ë²ˆ ê²Œì‹œê¸€ì„ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">ì‚­ì œ</a>
                                        </td>
                                    </tr>
                                </c:forEach>
                            </tbody>
                        </table>
                    </form>
            
                    <nav>
                        <ul class="pagination mt-4">
                            <c:if test="${pageInfo.currentPage > 1}">
                                <li class="page-item">
                                    <a class="page-link" href="?currentPage=${pageInfo.currentPage - 1}">ì´ì „</a>
                                </li>
                            </c:if>
            
                            <c:forEach var="p" begin="${pageInfo.startPage}" end="${pageInfo.endPage}">
                                <li class="page-item ${p == pageInfo.currentPage ? 'active' : ''}">
                                    <a class="page-link" href="?currentPage=${p}">${p}</a>
                                </li>
                            </c:forEach>
            
                            <c:if test="${pageInfo.currentPage < pageInfo.maxPage}">
                                <li class="page-item">
                                    <a class="page-link" href="?currentPage=${pageInfo.currentPage + 1}">ë‹¤ìŒ</a>
                                </li>
                            </c:if>
                        </ul>
                    </nav>
                </div>
                </div>
        </div> <%-- .main-content ë‹«ëŠ” íƒœê·¸ --%>
    </div> <%-- .admin-wrapper ë‹«ëŠ” íƒœê·¸ --%>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<%-- ì„ íƒ ì‚­ì œ ê¸°ëŠ¥ìš© ìŠ¤í¬ë¦½íŠ¸ --%>
<script>
    function submitPostAction(actionType) {
        const selectedCheckboxes = document.querySelectorAll('.itemCheckboxPost:checked');
        
        if (selectedCheckboxes.length === 0) {
            alert('ì„ íƒëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.');
            return;
        }

        if (confirm(`ì„ íƒëœ ê²Œì‹œê¸€ ${selectedCheckboxes.length}ê±´ì„ ì •ë§ ${actionType} ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
            const form = document.getElementById('postActionForm');
            form.action = '/community/admin/post/delete'; 
            form.method = 'post';
            form.submit();
        }
    }

    document.addEventListener('DOMContentLoaded', (event) => {
        const selectAllCheckbox = document.getElementById('selectAllCheckboxPost');
        const itemCheckboxes = document.querySelectorAll('.itemCheckboxPost');

        selectAllCheckbox.addEventListener('change', function() {
            itemCheckboxes.forEach(checkbox => {
                checkbox.checked = this.checked;
            });
        });
        
        itemCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                const checkedItems = document.querySelectorAll('.itemCheckboxPost:checked').length;
                if (!checkbox.checked) {
                    selectAllCheckbox.checked = false;
                } else if (checkedItems === itemCheckboxes.length) {
                    selectAllCheckbox.checked = true;
                }
            });
        });
    });
 </script>
</body>
</html>